<!DOCTYPE html>

<html lang='en'>
<head>
    <meta charset='utf-8'>    	
    <meta name='viewport' content='initial-scale=1, maximum-scale=1'>
    <title>ui.js demo</title>
    <link rel='shortcut icon' type='image/x-icon' href='misc/favicon_white.ico' />
    <link  type="text/css" href="vendors/kepler.css" rel="stylesheet"> 
    <link  type="text/css" href="css/ui.css" rel="stylesheet"> 
    <link  type="text/css" href="demo.css" rel="stylesheet"> 
    <link  type="text/css" href="css/info.css" rel="stylesheet"> 
    <script type='text/javascript' src='vendors/chroma.min.js'></script>
    <script type='module' src='./libs/ui.js'></script>    
</head>
<body>
    <script type='module'>
    import {UI, _el} from './libs/ui.js';
    // Move all this to UI.Demo
        // 0) Menu to show/hide the elements of the demo
        let demo = new UI.Demo();
        document.body.appendChild(demo);

        // shorthand for the parts
        let menu = demo.querySelector('#demo-menu');
        let components = demo.querySelector('#demo-components');

        /* 1) SIMPLE WIDGETS */
        let simple_widgets = _el({type: 'div', classes: ['demo-category'], innerText: 'Simple Widgets'});
        simple_widgets.onclick = () => {document.querySelectorAll('.demo-item.simple').forEach(i => i.classList.toggle('visible'))};
        menu.appendChild(simple_widgets)
        // 1.1) button
        // 1.1.1) add button
        let s_button = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'button w/ icon'}); 
        menu.appendChild(s_button);
        s_button.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Button', {id: 'button-demo', label: 'button', icon: 'add'});
        }
        // 1.1.2) Upload button
        let s_button_upload = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'button upload'}); 
        menu.appendChild(s_button_upload);
        s_button_upload.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Button', {id: 'upload-button-demo', label: 'upload'});
        }
        // 1.1.3) Cancel button
        let s_button_cancel = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'button cancel'}); 
        menu.appendChild(s_button_cancel);
        s_button_cancel.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Button', {id: 'cancel-button-demo', label: 'cancel', classes: ['cancel']});          
        }
        // 1.2) Checkbox
        // 1.2.1) Round
        let s_checkbox = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'checkbox round'}); 
        menu.appendChild(s_checkbox);
        s_checkbox.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('widget_CheckBox', {id: 'checkbox-demo', label: 'round', square: false});          
        }
        // 1.2.2) Square
        let s_checkbox_square = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'checkbox square'}); 
        menu.appendChild(s_checkbox_square);
        s_checkbox_square.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('widget_CheckBox', {id: 'checkbox_square-demo', label: 'square', square: true});         
        }

        // 1.3) DropDown
        let s_ddown = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'dropdown'}); 
        menu.appendChild(s_ddown);
        s_ddown.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('widget_DropDown', {id: 'dropdown-demo'});
        };

        // 1.4) Slider
        let s_slider = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'slider'}); 
        menu.appendChild(s_slider);
        s_slider.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('widget_Slider', {id: 'slider-demo', label: 'some kpi', value: 33});
        }

        // 1.5) Double Slider
        let s_dslider = _el({type: 'div', classes: ['demo-item', 'simple'], innerText: 'double slider'}); 
        menu.appendChild(s_dslider);
        s_dslider.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('widget_DoubleSlider', {id: 'double-slider-demo', label: 'some kpi range', min: -10, max: 20});         
        }         


        /* 2) COMPLEX WIDGETS */
        let complex_widgets = _el({type: 'div', classes: ['demo-category'], innerText: 'Complex Widgets'});
        complex_widgets.onclick = () => {document.querySelectorAll('.demo-item.complex').forEach(i => i.classList.toggle('visible'))};
        menu.appendChild(complex_widgets);

        // 2.1) Simple Panel
        let s_panel = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'panel'});
        menu.appendChild(s_panel);
        s_panel.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            let el_panel = components.querySelector('#panel_1');
            if (el_panel === null) {
                el_panel = new UI.Panel({id: 'panel_1', closable: true});
                // Add data to the panel
                let body = el_panel.querySelector('.panel-body');
                for (let i=0; i<15; i++) {
                    let div = _el({style: 'div'});
                    div.innerText = `Some text ${i}`;
                    div.classList.add('t_label');
                    body.appendChild(div);
                }
                components.appendChild(el_panel);
            } else {
                components.removeChild(el_panel);
            }
        };
        
        // 2.2) Header (left:0..2, titel:0..1, right:0..2 => 3x2x3=18)
        // 2.2.1) Left: 0 - Title: 0 - right: 0
        // 2.2.2) Left: 0 - Title: 1 - right: 0
        // 2.2.3) Left: 1 - Title: 0 - right: 1
        // 2.2.1) Left: 0 - Title: 0 - right: 0
        // 2.2.1) Left: 0 - Title: 0 - right: 0
        let s_header = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'header'}); 
        menu.appendChild(s_header);
        s_header.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Header', {id: 'header-demo', before: ['grab', 'eye_open'], after: ['settings', 'close']});         
        }

        // 2.3) Colorbar
        // 2.3.1) Example 1
        let s_cbar_ex1 = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'colorbar ex1'});
        menu.appendChild(s_cbar_ex1);
        s_cbar_ex1.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('DiscreteColorBar', {
                    id: 'colorbar-ex1-demo',
                    title: 'Quantity [unit]',
                    category: 'diverging',
                    scheme: 'Spectral',
                    n_colors: 7,
                    min: -10,
                    max: 31,
                    reverse: false
                });
        };
        // 2.3.2) Example 2
        let s_cbar_ex2 = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'colorbar ex2'});
        menu.appendChild(s_cbar_ex2);
        s_cbar_ex2.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('DiscreteColorBar', {                                
                            id: 'colorbar-ex2-demo',
                            title: 'Something [#]',
                            category: 'singlehue',
                            scheme: 'Purples',
                            n_colors: 4,
                            min: 0,
                            max: 100,
                            reverse: false
                            })
        };     

        // 2.3bis) heatmap example (to go along one of the examples above...or both!!)
        let s_heatmap = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'heatmap'}); 
        menu.appendChild(s_heatmap);
        s_heatmap.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Heatmap', {id: 'heatmap-demo'});         
        }

        let fake_items = {
            'item 1': 'int',
            'element 2 ': 'float',
            'component 3': 'string',
            'row 4': 'geo',
            'level 5': 'int',
            'section 5a': 'obj',
            'category 6': 'int',
            'channel 7': 'string',
            'subchannel 7z': 'mtl',
            'group 8': 'geo',
            'section 9': 'float',
            'subsection 9': 'json',
            'row 10': 'geo',
        };

        // 2.4) Item Grouper
        let s_grouper = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'item grouper'}); 
        menu.appendChild(s_grouper);
        s_grouper.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('ItemGrouper', {id: 'item-grouper-demo', selected: Object.keys(fake_items)});
        }

        // 2.5) item picker
        // 2.5.1) example 1
        let s_picker_ex1 = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'item picker ex1'}); 
        menu.appendChild(s_picker_ex1);
        s_picker_ex1.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('ItemPicker', {id: 'item-picker-ex1-demo', items: fake_items});
        }
        // 2.5.2) example 2
        let s_picker_ex2 = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'item picker ex2'}); 
        menu.appendChild(s_picker_ex2);
        s_picker_ex2.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('ItemPicker', {id: 'item-picker-ex2-demo'});
        }

        // 2.6) item griper
        // 2.6.1) example 1
        let s_griper = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'item griper'}); 
        menu.appendChild(s_griper);
        s_griper.onclick = (evt) => {
            evt.target.classList.toggle('clicked');  
            toggleComponent('ItemGriper', {id: 'item-griper-demo', items: fake_items});
        }
        // 2.6.6) example 2
        let s_griper_ex2 = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'item griper ex2'}); 
        menu.appendChild(s_griper_ex2);
        s_griper_ex2.onclick = (evt) => {
            evt.target.classList.toggle('clicked');  
            toggleComponent('ItemGriper', {id: 'item-griper-ex2-demo', fake: true});
        }

        // 2.7) tooltip: the one that shows detailed info about a hovered point
        let s_tooltip = _el({type: 'div', classes: ['demo-item', 'complex'], innerText: 'tooltip'}); 
        menu.appendChild(s_tooltip);
        s_tooltip.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Tooltip', {id: 'tooltip-demo'});         
        }


        /* 3) OTHER */
        let other_widgets = _el({type: 'div', classes: ['demo-category'], innerText: 'Other'});
        other_widgets.onclick = () => {document.querySelectorAll('.demo-item.other').forEach(i => i.classList.toggle('visible'))};
        menu.appendChild(other_widgets);
        // 3.1) Icons
        let s_icons = _el({type: 'div', classes: ['demo-item', 'other'], innerText: 'icons'});
        menu.appendChild(s_icons);
        s_icons.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('IconsShowCase', {id: 'icon-demo'});
        };

        // 3.2) resizable window
        // 3.2.1) empty div
        let s_resizable = _el({type: 'div', classes: ['demo-item', 'other'], innerText: 'resizable'}); 
        menu.appendChild(s_resizable);
        s_resizable.onclick = (evt) => {
            evt.target.classList.toggle('clicked');                       
            //toggleComponent('Resizer', {id: 'resizer-demo', parent: 'demo-components'});
            //UI.Resizer({id: 'resizer-demo', parent: 'demo-components'});
            
            let element = components.querySelector('#resizable-demo');
            if (element === null) {
                let div = _el({type: 'div', id: 'resizable-demo'});
                div.classList.add('resizable');
                div.style.width = '200px';
                div.style.height = '100px';
                div.style['background-color'] = '#204080C0';
                components.appendChild(div);
                UI.makeResizableDiv(div.id);
            } else {
                components.removeChild(element);
            }
        }
        // 3.2.2) Panel
        let s_resizable_panel = _el({type: 'div', classes: ['demo-item', 'other'], innerText: 'resizable panel'});
        menu.appendChild(s_resizable_panel);
        s_resizable_panel.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Panel', {id: 'resizable-panel-demo'});
            let element = components.querySelector('#resizable-panel-demo');
            if (element !== null) {
                UI.makeResizableDiv(element.id);
            }
        };        

        // 3.3) movable window
        let s_movable = _el({type: 'div', classes: ['demo-item', 'other'], innerText: 'movable'}); 
        menu.appendChild(s_movable);
        s_movable.onclick = (evt) => {
            alert(`${evt.target.innerText}: not implemented yet`);
        }

        // 3.4) Context menu
        let s_context = _el({type: 'div', classes: ['demo-item', 'other'], innerText: 'context menu'}); 
        menu.appendChild(s_context);
        s_context.onclick = (evt) => {
            UI.ContextMenu.toggle();
            evt.target.classList.toggle('clicked');
        };

        // 3.5) Fixed
        let s_fixed = _el({type: 'div', classes: ['demo-item', 'other'], innerText: 'fixed'}); 
        menu.appendChild(s_fixed);
        s_fixed.onclick = (evt) => {
            evt.target.classList.toggle('clicked');
            toggleComponent('Fixed', {id: 'fixed-demo', top: '100px', left: '50%'});
        };

        /* Helper function*/
        function toggleComponent(name, args) {
            /** 
             * toggle component on the page
             * assumption: id is included in args (no #)
            */
            let element = components.querySelector(`#${args.id}`);
            if (element === null) {
                if (name.includes('widget_')) {
                    name = name.split('_')[1];
                    element = new UI.Widget(name, args);
                } else {
                    element = new UI[name](args);
                }
                components.appendChild(element);
            } else {
                components.removeChild(element);
            }
        }


    </script>
</body>
</html>